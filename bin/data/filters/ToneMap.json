{
    "requires": [
        "solid"
    ],
    "textures": {
        "finalBuffer": {
        },
        "copyFinalBuffer": {
            "format": "R11G11B10_FLOAT",
            "flags": "target"
        },
        "luminanceBuffer": {
            "format": "R16_FLOAT",
            "flags": "target",
            "mipmaps": 0
        }
    },
    "buffers": {
        "averageLuminanceBuffer": {
            "format": "R32_FLOAT",
            "flags": "unorderedAccess",
            "count": 1
        }
    },
    "output": "finalBuffer",
    "passes": [
        {
            "program": "CalculateLuminance",
            "entry": "mainPixelProgram",
            "resources": [
                { "finalBuffer": "inputBuffer" }
            ],
            "targets": [
                "luminanceBuffer"
            ]
        },
        {
            "program": "AdaptLuminance",
            "entry": "mainComputeProgram",
            "mode": "compute",
            "dispatch": [ 1, 1, 1 ],
            "generateMipMaps": [
                "luminanceBuffer"
            ],
            "resources": [
                "luminanceBuffer"
            ],
            "unorderedAccess": [
                "averageLuminanceBuffer"
            ]
        },
        {
            "program": "ToneMap",
            "entry": "mainPixelProgram",
            "copy": {
                "copyFinalBuffer": "finalBuffer"
            },
            "resources": [
                "averageLuminanceBuffer",
                { "copyFinalBuffer": "inputBuffer" }
            ],
            "targets": [
                "finalBuffer"
            ]
        }
    ]
}