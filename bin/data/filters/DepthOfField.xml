<?xml version="1.0"?>
<filter>
    <textures>
        <backBuffer bind="float4" flags="target">R16G16B16A16_FLOAT</backBuffer>
        <frontBuffer bind="float4" flags="target">R16G16B16A16_FLOAT</frontBuffer>
        <depthBuffer bind="float" source="$standard" />
        <finalBuffer bind="float3" source="$standard" />
    </textures>

    <buffers>
        <averageFocalDepth size="1" flags="unorderedAccess">R32_FLOAT</averageFocalDepth>
    </buffers>

    <defines>
        <focusOuterDepth>5.0</focusOuterDepth>
        <focusInnerDepth>5.0</focusInnerDepth>
    </defines>

    <passes>
        <AdaptaverageFocalDepth compute="(1, 1, 1)" entry="mainComputeProgram">
            <resources>
                <depthBuffer />
            </resources>

            <unorderedaccess>
                <averageFocalDepth />
            </unorderedaccess>
        </AdaptaverageFocalDepth>

        <SeparateFields entry="mainPixelProgram">
            <resources>
                <averageFocalDepth />
                <finalBuffer />
                <depthBuffer />
            </resources>

            <targets>
                <backBuffer />
                <frontBuffer />
            </targets>
        </SeparateFields>


        <CalculateBlur entry="mainPixelProgram">
            <resources>
                <backBuffer />
                <frontBuffer />
                <averageFocalDepth />
                <finalBuffer />
                <depthBuffer />
            </resources>
        </CalculateBlur>
    </passes>
</filter>
